logSearches: true
logSearchResults: true
connections:
  testConnection:
    serverAddress: localhost
    port: 32191
indexes:
  publications:
    indexName: publications
    connection: testConnection
searches:
  pubsStar:
    index: publications
    queries:
      - q: "*:*"
        queryType: "FILTER"
  pubsWithoutTitle:
    index: publications
    queries:
      - q: "-title:*"
  pubsComplex:
    index: publications
    queries:
      - q: "title:*"
    facets:
      - field: pubYear
        topN: 10
      - field: journalNameIso
        topN: 10
    statFacets:
      - facetField: pubYear
        numericField: authorCount
        topN: 10
  pubsComplex2:
    index: publications
    queries:
      - q: "cancer"
        qf: [ "title","abstract" ]
    numStats:
      - numericField: pubYear
        percentiles: [ 0.1, 0.5, 0.9 ]
  pubsWithDocument:
    index: publications
    queries:
      - q: "title:\"Understanding PCSK9 and anti-PCSK9 therapies\""
    amount: 1
    documentFields: [ "authors" ]
tests:
  pubsCount:
    expr: pubsStar.count > 30000000
  mostPubsHaveTitle:
    expr: pubsWithoutTitle.count < pubsStar.count * 0.01
  oneResult:
    expr: pubsWithDocument.count == 1
  resultHasCorrectAuthor:
    expr: pubsWithDocument.doc[0]["authors"][0]["lastName"] == "McKenney"
  topYearFacet:
    expr: pubsComplex.facet["pubYear"][0].label == "2022" && pubsComplex.facet["pubYear"][0].count > 1000000
  topJournalFacet:
    expr: pubsComplex.facet["journalNameIso"][0].label = "PLoS One" && pubsComplex.facet["journalNameIso"][0].count > 1000
  statFacetCheck:
    expr: pubsComplex.statFacet["pubYear-authorCount"][0].label = "2022" && pubsComplex.statFacet["pubYear-authorCount"][0].docCount > 1000000 && pubsComplex.statFacet["pubYear-authorCount"][0].sum > 5000000
  numStatCheck:
    expr: (pubsComplex2.numStat["pubYear"].sum/pubsComplex2.numStat["pubYear"].docCount) > 2008
  numStatCheck2:
    expr: (pubsComplex2.numStat["pubYear"].percentiles[0].value < 1996) && (pubsComplex2.numStat["pubYear"].percentiles[2].value > 2021)

